import{k as P,u as $,r as a,j as e,S as O,M as U}from"./index-Zlyefp4M.js";const D=()=>{const h="/api/v1",{id:p}=P(),d=$(),[r,u]=a.useState({topicName:""}),[c,g]=a.useState({topicName:""}),[N,m]=a.useState(!1),[j,b]=a.useState(""),[v,T]=a.useState(""),[f,k]=a.useState(!1),[C,i]=a.useState(!1),[x,y]=a.useState("");a.useEffect(()=>{(async()=>{i(!0);try{const t=localStorage.getItem("token"),s=await fetch(`${h}/topics/${p}`,{method:"GET",headers:{Authorization:`Bearer ${t}`,"Content-Type":"application/json"}});if(s.status===401){const L=await s.json();y(L.detail),n("Thông báo","Phiên đăng nhập đã hết hạn, vui lòng đăng nhập lại.",!0),i(!1);return}const l=await s.json();l?u({topicName:l.topicName}):n("Lỗi","Không tìm thấy chủ đề.",!0)}catch{n("Lỗi","Có lỗi xảy ra khi tải dữ liệu.",!0)}finally{i(!1)}})()},[p,h]);const S=o=>{const{name:t,value:s}=o.target;u({...r,[t]:s}),g({...c,[t]:""})},w=()=>r.topicName.trim()?r.topicName.length>100?(g({...c,topicName:"Tên chủ đề không được dài quá 100 ký tự."}),!1):!0:(g({...c,topicName:"Tên chủ đề không được để trống."}),!1),M=async()=>{if(w()){i(!0);try{const o=localStorage.getItem("token"),t=await fetch(`${h}/topics`,{method:"PUT",headers:{Authorization:`Bearer ${o}`,"Content-Type":"application/json"},body:JSON.stringify({id:p,topicName:r.topicName})});if(t.status===401){const l=await t.json();y(l.detail),n("Thông báo","Phiên đăng nhập đã hết hạn, vui lòng đăng nhập lại.",!0),i(!1);return}const s=await t.json();s&&s.message==="updated"?n("Thành công","Cập nhật thành công!",!1):n("Lỗi","Cập nhật không thành công.",!0)}catch{n("Lỗi","Có lỗi xảy ra khi cập nhật.",!0)}finally{i(!1)}}},I=()=>{d(-1)},n=(o,t,s)=>{b(o),T(t),k(s),m(!0)},E=()=>{m(!1),f||d(-1),(x=="invalid_token"||x=="jwt_error")&&(localStorage.removeItem("token"),localStorage.removeItem("username"),localStorage.removeItem("roles"),d("/"))};return e.jsxs("div",{className:"flex items-center justify-center min-h-screen p-4 bg-gray-100 relative",children:[C&&e.jsx("div",{className:"fixed inset-0 bg-gray-800 bg-opacity-50 flex items-center justify-center z-50",children:e.jsx(O,{})}),e.jsxs("div",{className:"bg-white rounded-lg shadow-lg p-6 w-full max-w-md",children:[e.jsx("h2",{className:"text-2xl font-bold mb-4 text-gray-800 text-center",children:"Cập Nhật Chủ Đề"}),e.jsxs("div",{children:[e.jsxs("div",{className:"mb-4",children:[e.jsx("label",{htmlFor:"topicName",className:"block text-gray-700 font-medium mb-2",children:"Tên Chủ Đề"}),e.jsx("input",{type:"text",id:"topicName",name:"topicName",value:r.topicName,onChange:S,className:"w-full px-4 py-2 border rounded-lg focus:outline-none focus:ring focus:ring-indigo-300",placeholder:"Nhập tên chủ đề"}),c.topicName&&e.jsx("p",{className:"text-red-500 text-sm mt-2",children:c.topicName})]}),e.jsxs("div",{className:"flex justify-center gap-4",children:[e.jsx("button",{type:"button",onClick:M,className:"px-4 py-2 bg-indigo-500 text-white rounded-lg hover:bg-indigo-600 focus:outline-none focus:ring focus:ring-indigo-300",children:"Cập Nhật"}),e.jsx("button",{type:"button",onClick:I,className:"px-4 py-2 bg-gray-300 text-gray-700 rounded-lg hover:bg-gray-400 focus:outline-none focus:ring focus:ring-gray-200",children:"Hủy"})]})]})]}),e.jsx(U,{isOpen:N,onClose:E,title:j,message:v,isError:f})]})};export{D as default};

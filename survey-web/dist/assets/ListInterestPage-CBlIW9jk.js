import{r as t,u as F,j as e,S as R,h as V,i as _,M as G}from"./index-CQdfBo2t.js";import{C as U}from"./ConfirmModal-DPzGQM7w.js";const J=()=>{const m="/api/v1",[S,u]=t.useState([]),[C,l]=t.useState(!1),[v,b]=t.useState(!1),[I,T]=t.useState(""),[k,E]=t.useState(""),[M,$]=t.useState(!1),[D,i]=t.useState(!1),[g,j]=t.useState(null),[f,y]=t.useState(""),N=F(),[w,L]=t.useState(0),[n,d]=t.useState(0),h=10;t.useEffect(()=>{P(n,h)},[g,n,h]);const P=async(s=0,a=h)=>{l(!0);try{const o=localStorage.getItem("token"),z=s*a,p=await fetch(`${m}/interests?skip=${z}&limit=${a}`,{method:"GET",headers:{Authorization:`Bearer ${o}`,"Content-Type":"application/json"}});if(p.status===401){const x=await p.json();y(x.detail),r("Thông báo","Phiên đăng nhập đã hết hạn, vui lòng đăng nhập lại.",!0),l(!1);return}const c=await p.json();if(c&&Array.isArray(c.content)){if(u(c.content),c.totalCount){const x=Math.ceil(c.totalCount/a);L(x)}}else u([]);d(s)}catch{r("Lỗi","Có lỗi xảy ra khi tải dữ liệu.",!0)}finally{l(!1)}},O=s=>{N(`/dashboard/update-interest/${s}`)},X=s=>{j(s),i(!0)},A=async()=>{i(!1),l(!0);try{const s=localStorage.getItem("token"),a=await fetch(`${m}/interests/${g}`,{method:"DELETE",headers:{Authorization:`Bearer ${s}`,"Content-Type":"application/json"}});if(a.status===401){const o=await a.json();y(o.detail),r("Thông báo","Phiên đăng nhập đã hết hạn, vui lòng đăng nhập lại.",!0),l(!1);return}a.ok?r("Thành công","Xóa thành công!",!1):r("Lỗi","Xóa không thành công.",!0)}catch{r("Lỗi","Có lỗi xảy ra khi xóa.",!0)}finally{l(!1),j(null)}},r=(s,a,o)=>{T(s),E(a),$(o),b(!0)},B=()=>{b(!1),(f=="invalid_token"||f=="jwt_error")&&(localStorage.removeItem("token"),localStorage.removeItem("username"),localStorage.removeItem("roles"),N("/"))};return e.jsxs("div",{className:"flex items-center justify-center min-h-screen p-4 bg-gray-100 relative w-full",children:[C&&e.jsx("div",{className:"fixed inset-0 bg-gray-800 bg-opacity-50 flex items-center justify-center z-50",children:e.jsx(R,{})}),e.jsx("div",{className:"container mx-auto p-1",children:e.jsxs("div",{className:"bg-white p-1 rounded shadow-md w-full",children:[e.jsx("h2",{className:"text-2xl mb-4 text-gray-800",children:"Danh Sách Sở Thích"}),e.jsx("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-4 overflow-x-auto",children:e.jsxs("table",{className:"min-w-full bg-white",children:[e.jsx("thead",{children:e.jsxs("tr",{children:[e.jsx("th",{className:"py-2 px-4 border-b whitespace-nowrap",children:"NetSoc Code"}),e.jsx("th",{className:"py-2 px-4 border-b whitespace-nowrap",children:"Title"}),e.jsx("th",{className:"py-2 px-4 border-b whitespace-nowrap",children:"Element ID"}),e.jsx("th",{className:"py-2 px-4 border-b whitespace-nowrap",children:"Element Name"}),e.jsx("th",{className:"py-2 px-4 border-b whitespace-nowrap",children:"Scale ID"}),e.jsx("th",{className:"py-2 px-4 border-b whitespace-nowrap",children:"Scale Name"}),e.jsx("th",{className:"py-2 px-4 border-b whitespace-nowrap",children:"Data Value"}),e.jsx("th",{className:"py-2 px-4 border-b whitespace-nowrap",children:"Sửa"}),e.jsx("th",{className:"py-2 px-4 border-b whitespace-nowrap",children:"Xóa"})]})}),e.jsx("tbody",{children:S.map(s=>e.jsxs("tr",{children:[e.jsx("td",{className:"py-2 px-4 border-b",children:s.netSocCode}),e.jsx("td",{className:"py-2 px-4 border-b",children:s.title}),e.jsx("td",{className:"py-2 px-4 border-b",children:s.elementId}),e.jsx("td",{className:"py-2 px-4 border-b",children:s.elementName}),e.jsx("td",{className:"py-2 px-4 border-b",children:s.scaleId}),e.jsx("td",{className:"py-2 px-4 border-b",children:s.scaleName}),e.jsx("td",{className:"py-2 px-4 border-b",children:s.dataValue}),e.jsx("td",{className:"py-2 px-4 border-b",children:e.jsxs("button",{onClick:()=>O(s.id),className:"text-blue-500 hover:text-blue-700 flex items-center",children:[e.jsx(V,{}),e.jsx("span",{className:"hidden sm:inline",children:"Sửa"})]})}),e.jsx("td",{className:"py-2 px-4 border-b",children:e.jsxs("button",{onClick:()=>X(s.id),className:"text-red-500 hover:text-red-700 flex items-center",children:[e.jsx(_,{}),e.jsx("span",{className:"hidden sm:inline",children:"Xóa"})]})})]},s.id))})]})}),e.jsxs("div",{className:"flex justify-center mt-4",children:[e.jsx("button",{onClick:()=>d(n-1),disabled:n<=0,className:"px-4 py-2 bg-blue-500 text-white rounded mr-2 disabled:bg-gray-400 disabled:cursor-not-allowed",children:"Trước"}),e.jsx("span",{className:"px-4 py-2",children:`Trang ${n+1} / ${w}`}),e.jsx("button",{onClick:()=>d(n+1),disabled:n>=w-1,className:"px-4 py-2 bg-blue-500 text-white rounded ml-2 disabled:bg-gray-400 disabled:cursor-not-allowed",children:"Sau"})]})]})}),e.jsx(U,{isOpen:D,onClose:()=>i(!1),onConfirm:A,title:"Xác nhận xóa",message:"Bạn có chắc chắn muốn xóa sở thích này không?"}),e.jsx(G,{isOpen:v,onClose:B,title:I,message:k,isError:M})]})};export{J as default};

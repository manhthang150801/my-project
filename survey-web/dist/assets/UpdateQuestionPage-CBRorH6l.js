import{k as F,u as z,r as o,j as e,S as H,M as O}from"./index-Ca3LY0Wa.js";const A=()=>{const d="/api/v1",{id:h}=F(),p=z(),[l,x]=o.useState({question:"",type:"",topicId:""}),[c,y]=o.useState({question:"",type:"",topicId:""}),[N,C]=o.useState([]),[I,j]=o.useState(!1),[k,w]=o.useState(""),[S,T]=o.useState(""),[b,q]=o.useState(!1),[L,a]=o.useState(!1),[v,g]=o.useState("");o.useEffect(()=>{const t=async()=>{a(!0);try{const n=localStorage.getItem("token"),r=await fetch(`${d}/questions/${h}`,{method:"GET",headers:{Authorization:`Bearer ${n}`,"Content-Type":"application/json"}});if(r.status===401){const f=await r.json();g(f.detail),i("Thông báo","Phiên đăng nhập đã hết hạn, vui lòng đăng nhập lại.",!0),a(!1);return}const u=await r.json();u?x({question:u.question,type:u.type,topicId:u.topicId}):i("Lỗi","Không tìm thấy câu hỏi.",!0)}catch{i("Lỗi","Có lỗi xảy ra khi tải dữ liệu.",!0)}finally{a(!1)}},s=async()=>{a(!0);try{const n=localStorage.getItem("token"),r=await fetch(`${d}/topics`,{method:"GET",headers:{Authorization:`Bearer ${n}`,"Content-Type":"application/json"}});if(r.status===401){const f=await r.json();g(f.detail),i("Thông báo","Phiên đăng nhập đã hết hạn, vui lòng đăng nhập lại.",!0),a(!1);return}const u=await r.json();C(u)}catch{i("Lỗi","Có lỗi xảy ra khi tải dữ liệu.",!0)}finally{a(!1)}};t(),s()},[h,d]);const m=t=>{const{name:s,value:n}=t.target;x({...l,[s]:n}),y({...c,[s]:""})},M=()=>{let t=!0;const s={question:"",type:"",topicId:""};return l.question.trim()||(s.question="Câu hỏi không được để trống.",t=!1),l.type.trim()||(s.type="Loại câu hỏi không được để trống.",t=!1),l.topicId||(s.topicId="Vui lòng chọn chủ đề.",t=!1),y(s),t},E=async()=>{if(M()){a(!0);try{const t=localStorage.getItem("token"),s=await fetch(`${d}/questions`,{method:"PUT",headers:{Authorization:`Bearer ${t}`,"Content-Type":"application/json"},body:JSON.stringify({id:h,...l})});if(s.status===401){const r=await s.json();g(r.detail),i("Thông báo","Phiên đăng nhập đã hết hạn, vui lòng đăng nhập lại.",!0),a(!1);return}const n=await s.json();n&&n.message==="updated"?i("Thành công","Cập nhật thành công!",!1):i("Lỗi","Cập nhật không thành công.",!0)}catch{i("Lỗi","Có lỗi xảy ra khi cập nhật.",!0)}finally{a(!1)}}},$=()=>{p(-1)},i=(t,s,n)=>{w(t),T(s),q(n),j(!0)},P=()=>{j(!1),b||p(-1),(v=="invalid_token"||v=="jwt_error")&&(localStorage.removeItem("token"),localStorage.removeItem("username"),localStorage.removeItem("roles"),p("/"))};return e.jsxs("div",{className:"flex items-center justify-center min-h-screen p-4 bg-gray-100 relative",children:[L&&e.jsx("div",{className:"fixed inset-0 bg-gray-800 bg-opacity-50 flex items-center justify-center z-50",children:e.jsx(H,{})}),e.jsxs("div",{className:"bg-white rounded-lg shadow-lg p-6 w-full max-w-md",children:[e.jsx("h2",{className:"text-2xl font-bold mb-4 text-gray-800 text-center",children:"Cập Nhật Câu Hỏi"}),e.jsxs("div",{children:[e.jsxs("div",{className:"mb-4",children:[e.jsx("label",{htmlFor:"question",className:"block text-gray-700 font-medium mb-2",children:"Câu Hỏi"}),e.jsx("input",{type:"text",id:"question",name:"question",value:l.question,onChange:m,className:"w-full px-4 py-2 border rounded-lg focus:outline-none focus:ring focus:ring-indigo-300",placeholder:"Nhập câu hỏi"}),c.question&&e.jsx("p",{className:"text-red-500 text-sm mt-2",children:c.question})]}),e.jsxs("div",{className:"mb-4",children:[e.jsx("label",{htmlFor:"type",className:"block text-gray-700 font-medium mb-2",children:"Loại Câu Hỏi"}),e.jsx("input",{type:"text",id:"type",name:"type",value:l.type,onChange:m,className:"w-full px-4 py-2 border rounded-lg focus:outline-none focus:ring focus:ring-indigo-300",placeholder:"Nhập loại câu hỏi"}),c.type&&e.jsx("p",{className:"text-red-500 text-sm mt-2",children:c.type})]}),e.jsxs("div",{className:"mb-4",children:[e.jsx("label",{htmlFor:"topicId",className:"block text-gray-700 font-medium mb-2",children:"Chủ Đề"}),e.jsxs("select",{id:"topicId",name:"topicId",value:l.topicId,onChange:m,className:"w-full px-4 py-2 border rounded-lg focus:outline-none focus:ring focus:ring-indigo-300",children:[e.jsx("option",{value:"",children:"Chọn chủ đề"}),N.map(t=>e.jsx("option",{value:t.id,children:t.topicName},t.id))]}),c.topicId&&e.jsx("p",{className:"text-red-500 text-sm mt-2",children:c.topicId})]}),e.jsxs("div",{className:"flex justify-center gap-4",children:[e.jsx("button",{type:"button",onClick:E,className:"px-4 py-2 bg-indigo-500 text-white rounded-lg hover:bg-indigo-600 focus:outline-none focus:ring focus:ring-indigo-300",children:"Cập Nhật"}),e.jsx("button",{type:"button",onClick:$,className:"px-4 py-2 bg-gray-300 text-gray-700 rounded-lg hover:bg-gray-400 focus:outline-none focus:ring focus:ring-gray-200",children:"Hủy"})]})]})]}),e.jsx(O,{isOpen:I,onClose:P,title:k,message:S,isError:b})]})};export{A as default};

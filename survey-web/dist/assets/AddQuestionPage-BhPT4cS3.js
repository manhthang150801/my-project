import{r as o,j as e,S as E,M as F}from"./index-Ca3LY0Wa.js";const H=()=>{const h="/api/v1",[i,p]=o.useState({question:"",type:"",topicId:""}),[a,c]=o.useState({question:"",type:"",topicId:""}),[y,j]=o.useState([]),[b,g]=o.useState(!1),[v,N]=o.useState(""),[I,S]=o.useState(""),[C,w]=o.useState(!1),[k,l]=o.useState(!1),[m,f]=o.useState("");o.useEffect(()=>{(async()=>{l(!0);try{const s=localStorage.getItem("token"),n=await fetch(`${h}/topics`,{method:"GET",headers:{Authorization:`Bearer ${s}`,"Content-Type":"application/json"}});if(n.status===401){const M=await n.json();f(M.detail),r("Thông báo","Phiên đăng nhập đã hết hạn, vui lòng đăng nhập lại.",!0),l(!1);return}const u=await n.json();j(u)}catch{r("Lỗi","Có lỗi xảy ra khi tải dữ liệu.",!0)}finally{l(!1)}})()},[]);const d=t=>{const{name:s,value:n}=t.target;p({...i,[s]:n}),c({...a,[s]:""})},T=()=>{let t=!0;const s={question:"",type:"",topicId:""};return i.question.trim()||(s.question="Câu hỏi không được để trống.",t=!1),i.type.trim()||(s.type="Loại câu hỏi không được để trống.",t=!1),i.topicId||(s.topicId="Vui lòng chọn chủ đề.",t=!1),c(s),t},q=async()=>{if(T()){l(!0);try{const t=localStorage.getItem("token"),s=await fetch(`${h}/questions`,{method:"POST",headers:{Authorization:`Bearer ${t}`,"Content-Type":"application/json"},body:JSON.stringify(i)});if(s.status===401){const u=await s.json();f(u.detail),r("Thông báo","Phiên đăng nhập đã hết hạn, vui lòng đăng nhập lại.",!0),l(!1);return}const n=await s.json();n&&n.message==="saved"?r("Thành công","Lưu câu hỏi thành công!",!1):r("Lỗi","Lưu câu hỏi không thành công.",!0)}catch{r("Lỗi","Có lỗi xảy ra.",!0)}finally{x(),l(!1)}}},x=()=>{p({question:"",type:"",topicId:""}),c({question:"",type:"",topicId:""})},r=(t,s,n)=>{N(t),S(s),w(n),g(!0)},L=()=>{g(!1),(m=="invalid_token"||m=="jwt_error")&&(localStorage.removeItem("token"),localStorage.removeItem("username"),localStorage.removeItem("roles"),navigate("/"))};return e.jsxs("div",{className:"flex items-center justify-center min-h-screen p-4 bg-gray-100 relative",children:[k&&e.jsx("div",{className:"fixed inset-0 bg-gray-800 bg-opacity-50 flex items-center justify-center z-50",children:e.jsx(E,{})}),e.jsxs("div",{className:"bg-white rounded-lg shadow-lg p-6 w-full max-w-md",children:[e.jsx("h2",{className:"text-2xl font-bold mb-4 text-gray-800 text-center",children:"Thêm Câu Hỏi"}),e.jsxs("div",{children:[e.jsxs("div",{className:"mb-4",children:[e.jsx("label",{htmlFor:"question",className:"block text-gray-700 font-medium mb-2",children:"Câu Hỏi"}),e.jsx("input",{type:"text",id:"question",name:"question",value:i.question,onChange:d,className:"w-full px-4 py-2 border rounded-lg focus:outline-none focus:ring focus:ring-indigo-300",placeholder:"Nhập câu hỏi"}),a.question&&e.jsx("p",{className:"text-red-500 text-sm mt-2",children:a.question})]}),e.jsxs("div",{className:"mb-4",children:[e.jsx("label",{htmlFor:"type",className:"block text-gray-700 font-medium mb-2",children:"Loại Câu Hỏi"}),e.jsx("input",{type:"text",id:"type",name:"type",value:i.type,onChange:d,className:"w-full px-4 py-2 border rounded-lg focus:outline-none focus:ring focus:ring-indigo-300",placeholder:"Nhập loại câu hỏi"}),a.type&&e.jsx("p",{className:"text-red-500 text-sm mt-2",children:a.type})]}),e.jsxs("div",{className:"mb-4",children:[e.jsx("label",{htmlFor:"topicId",className:"block text-gray-700 font-medium mb-2",children:"Chủ Đề"}),e.jsxs("select",{id:"topicId",name:"topicId",value:i.topicId,onChange:d,className:"w-full px-4 py-2 border rounded-lg focus:outline-none focus:ring focus:ring-indigo-300",children:[e.jsx("option",{value:"",children:"Chọn chủ đề"}),y.map(t=>e.jsx("option",{value:t.id,children:t.topicName},t.id))]}),a.topicId&&e.jsx("p",{className:"text-red-500 text-sm mt-2",children:a.topicId})]}),e.jsxs("div",{className:"flex justify-center gap-4",children:[e.jsx("button",{type:"button",onClick:q,className:"px-4 py-2 bg-indigo-500 text-white rounded-lg hover:bg-indigo-600 focus:outline-none focus:ring focus:ring-indigo-300",children:"Lưu"}),e.jsx("button",{type:"button",onClick:x,className:"px-4 py-2 bg-gray-300 text-gray-700 rounded-lg hover:bg-gray-400 focus:outline-none focus:ring focus:ring-gray-200",children:"Hủy"})]})]})]}),e.jsx(F,{isOpen:b,onClose:L,title:v,message:I,isError:C})]})};export{H as default};

import{r as t,u as D,j as e,S as O,h as $,i as X,M as Q}from"./index-CQdfBo2t.js";import{C as z}from"./ConfirmModal-DPzGQM7w.js";const A=()=>{const l="/api/v1",[c,d]=t.useState([]),[j,o]=t.useState(!1),[g,h]=t.useState(!1),[b,y]=t.useState(""),[N,w]=t.useState(""),[S,v]=t.useState(!1),[C,i]=t.useState(!1),[p,x]=t.useState(null),[m,u]=t.useState(""),f=D();t.useEffect(()=>{T()},[]);const T=async()=>{o(!0);try{const s=localStorage.getItem("token"),a=await fetch(`${l}/questions`,{method:"GET",headers:{Authorization:`Bearer ${s}`,"Content-Type":"application/json"}});if(a.status===401){const L=await a.json();u(L.detail),r("Thông báo","Phiên đăng nhập đã hết hạn, vui lòng đăng nhập lại.",!0),o(!1);return}const n=await a.json();d(n)}catch{r("Lỗi","Có lỗi xảy ra khi tải dữ liệu.",!0)}finally{o(!1)}},k=s=>{f(`/dashboard/update-question/${s}`)},E=s=>{x(s),i(!0)},I=async()=>{i(!1),o(!0);try{const s=localStorage.getItem("token"),a=await fetch(`${l}/questions/${p}`,{method:"DELETE",headers:{Authorization:`Bearer ${s}`,"Content-Type":"application/json"}});if(a.status===401){const n=await a.json();u(n.detail),r("Thông báo","Phiên đăng nhập đã hết hạn, vui lòng đăng nhập lại.",!0),o(!1);return}a.ok?(d(c.filter(n=>n.id!==p)),r("Thành công","Xóa thành công!",!1)):r("Lỗi","Xóa không thành công.",!0)}catch{r("Lỗi","Có lỗi xảy ra khi xóa.",!0)}finally{o(!1),x(null)}},r=(s,a,n)=>{y(s),w(a),v(n),h(!0)},M=()=>{h(!1),(m=="invalid_token"||m=="jwt_error")&&(localStorage.removeItem("token"),localStorage.removeItem("username"),localStorage.removeItem("roles"),f("/"))};return e.jsxs("div",{className:"flex items-center justify-center min-h-screen p-4 bg-gray-100 relative",children:[j&&e.jsx("div",{className:"fixed inset-0 bg-gray-800 bg-opacity-50 flex items-center justify-center z-50",children:e.jsx(O,{})}),e.jsx("div",{className:"container mx-auto p-1",children:e.jsxs("div",{className:"bg-white p-1 rounded shadow-md w-full",children:[e.jsx("h2",{className:"text-2xl mb-4 text-gray-800",children:"Danh Sách Câu Hỏi"}),e.jsx("div",{className:"overflow-x-auto",children:e.jsxs("table",{className:"w-full bg-white",children:[e.jsx("thead",{children:e.jsxs("tr",{children:[e.jsx("th",{className:"py-2 px-4 border-b whitespace-nowrap",children:"Tên Câu Hỏi"}),e.jsx("th",{className:"py-2 px-4 border-b whitespace-nowrap",children:"Loại"}),e.jsx("th",{className:"py-2 px-4 border-b whitespace-nowrap",children:"Chủ Đề"}),e.jsx("th",{className:"py-2 px-4 border-b whitespace-nowrap",children:"Sửa"}),e.jsx("th",{className:"py-2 px-4 border-b whitespace-nowrap",children:"Xóa"})]})}),e.jsx("tbody",{children:c.map(s=>e.jsxs("tr",{children:[e.jsx("td",{className:"py-2 px-4 border-b",children:s.question}),e.jsx("td",{className:"py-2 px-4 border-b",children:s.type}),e.jsx("td",{className:"py-2 px-4 border-b",children:s.topicName}),e.jsx("td",{className:"py-2 px-4 border-b",children:e.jsxs("button",{onClick:()=>k(s.id),className:"text-blue-500 hover:text-blue-700 flex items-center",children:[e.jsx($,{}),e.jsx("span",{className:"hidden sm:inline",children:"Sửa"})]})}),e.jsx("td",{className:"py-2 px-4 border-b",children:e.jsxs("button",{onClick:()=>E(s.id),className:"text-red-500 hover:text-red-700 flex items-center",children:[e.jsx(X,{}),e.jsx("span",{className:"hidden sm:inline",children:"Xóa"})]})})]},s.id))})]})})]})}),e.jsx(z,{isOpen:C,onClose:()=>i(!1),onConfirm:I,title:"Xác nhận xóa",message:"Bạn có chắc chắn muốn xóa câu hỏi này không?"}),e.jsx(Q,{isOpen:g,onClose:M,title:b,message:N,isError:S})]})};export{A as default};

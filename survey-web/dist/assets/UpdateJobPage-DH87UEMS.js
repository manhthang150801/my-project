import{k as P,u as $,r as a,j as e,S as F,M as J}from"./index-Zlyefp4M.js";const U=()=>{const d="/api/v1",{id:g}=P(),h=$(),[s,m]=a.useState({jobCode:"",jobName:""}),[l,u]=a.useState({jobCode:"",jobName:""}),[N,p]=a.useState(!1),[y,C]=a.useState(""),[v,k]=a.useState(""),[b,S]=a.useState(!1),[w,r]=a.useState(!1),[j,f]=a.useState("");a.useEffect(()=>{(async()=>{r(!0);try{const t=localStorage.getItem("token"),n=await fetch(`${d}/jobs/${g}`,{method:"GET",headers:{Authorization:`Bearer ${t}`,"Content-Type":"application/json"}});if(n.status===401){const L=await n.json();f(L.detail),i("Thông báo","Phiên đăng nhập đã hết hạn, vui lòng đăng nhập lại.",!0),r(!1);return}const c=await n.json();c?m({jobCode:c.jobCode,jobName:c.jobName}):i("Lỗi","Không tìm thấy nghề nghiệp.",!0)}catch{i("Lỗi","Có lỗi xảy ra khi tải dữ liệu.",!0)}finally{r(!1)}})()},[g,d]);const x=o=>{const{name:t,value:n}=o.target;m({...s,[t]:n}),u({...l,[t]:""})},T=()=>{let o=!0,t={jobCode:"",jobName:""};return s.jobCode.trim()||(t.jobCode="Mã nghề nghiệp không được để trống.",o=!1),s.jobCode.length>50&&(t.jobCode="Mã nghề nghiệp không được dài quá 50 ký tự.",o=!1),s.jobName.trim()||(t.jobName="Tên nghề nghiệp không được để trống.",o=!1),s.jobName.length>100&&(t.jobName="Tên nghề nghiệp không được dài quá 100 ký tự.",o=!1),u(t),o},M=async()=>{if(T()){r(!0);try{const o=localStorage.getItem("token"),t=await fetch(`${d}/jobs`,{method:"PUT",headers:{Authorization:`Bearer ${o}`,"Content-Type":"application/json"},body:JSON.stringify({id:g,jobCode:s.jobCode,jobName:s.jobName})});if(t.status===401){const c=await t.json();f(c.detail),i("Thông báo","Phiên đăng nhập đã hết hạn, vui lòng đăng nhập lại.",!0),r(!1);return}const n=await t.json();n&&n.message==="updated"?i("Thành công","Cập nhật thành công!",!1):i("Lỗi","Cập nhật không thành công.",!0)}catch{i("Lỗi","Có lỗi xảy ra khi cập nhật.",!0)}finally{r(!1)}}},E=()=>{h(-1)},i=(o,t,n)=>{C(o),k(t),S(n),p(!0)},I=()=>{p(!1),b||h(-1),(j=="invalid_token"||j=="jwt_error")&&(localStorage.removeItem("token"),localStorage.removeItem("username"),localStorage.removeItem("roles"),h("/"))};return e.jsxs("div",{className:"flex items-center justify-center min-h-screen p-4 bg-gray-100 relative",children:[w&&e.jsx("div",{className:"fixed inset-0 bg-gray-800 bg-opacity-50 flex items-center justify-center z-50",children:e.jsx(F,{})}),e.jsxs("div",{className:"bg-white rounded-lg shadow-lg p-6 w-full max-w-md",children:[e.jsx("h2",{className:"text-2xl font-bold mb-4 text-gray-800 text-center",children:"Cập Nhật Nghề Nghiệp"}),e.jsxs("div",{children:[e.jsxs("div",{className:"mb-4",children:[e.jsx("label",{htmlFor:"jobCode",className:"block text-gray-700 font-medium mb-2",children:"Mã Nghề Nghiệp"}),e.jsx("input",{type:"text",id:"jobCode",name:"jobCode",value:s.jobCode,onChange:x,className:"w-full px-4 py-2 border rounded-lg focus:outline-none focus:ring focus:ring-indigo-300",placeholder:"Nhập mã nghề nghiệp"}),l.jobCode&&e.jsx("p",{className:"text-red-500 text-sm mt-2",children:l.jobCode})]}),e.jsxs("div",{className:"mb-4",children:[e.jsx("label",{htmlFor:"jobName",className:"block text-gray-700 font-medium mb-2",children:"Tên Nghề Nghiệp"}),e.jsx("input",{type:"text",id:"jobName",name:"jobName",value:s.jobName,onChange:x,className:"w-full px-4 py-2 border rounded-lg focus:outline-none focus:ring focus:ring-indigo-300",placeholder:"Nhập tên nghề nghiệp"}),l.jobName&&e.jsx("p",{className:"text-red-500 text-sm mt-2",children:l.jobName})]}),e.jsxs("div",{className:"flex justify-center gap-4",children:[e.jsx("button",{type:"button",onClick:M,className:"px-4 py-2 bg-indigo-500 text-white rounded-lg hover:bg-indigo-600 focus:outline-none focus:ring focus:ring-indigo-300",children:"Cập Nhật"}),e.jsx("button",{type:"button",onClick:E,className:"px-4 py-2 bg-gray-300 text-gray-700 rounded-lg hover:bg-gray-400 focus:outline-none focus:ring focus:ring-gray-200",children:"Hủy"})]})]})]}),e.jsx(J,{isOpen:N,onClose:I,title:y,message:v,isError:b})]})};export{U as default};

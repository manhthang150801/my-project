import{r as a,j as e,S as me,f as xe,g as u,M as ue}from"./index-pkM7sRJn.js";const pe=()=>{const d="/api/v1",[w,C]=a.useState([]),[L,G]=a.useState([]),[I,h]=a.useState(!1),[A,S]=a.useState(!1),[F,Q]=a.useState(""),[B,U]=a.useState(""),[H,K]=a.useState(!1),[g,k]=a.useState({}),[c,m]=a.useState({}),[D,p]=a.useState(!1),[i,T]=a.useState({gender:"",age:"",education:"",income:"",employed:"",profession:"",vernacular:""}),[_,J]=a.useState([]),[q,z]=a.useState([]),[b,W]=a.useState([]),[l,O]=a.useState(null),[X,$]=a.useState(""),[Y,y]=a.useState(b),[N,E]=a.useState(0),[o,f]=a.useState(0),v=10;a.useEffect(()=>{Z(o,v)},[o,v]),a.useEffect(()=>{h(!0);try{ee(),se(),te(),ne()}catch{j("Lỗi","Có lỗi xảy ra khi tải dữ liệu.",!0)}finally{h(!1)}},[]);const Z=async(s=0,t=v)=>{h(!0);try{const n=s*t,x=await(await fetch(`${d}/guest/questions?skip=${n}&limit=${t}`,{method:"GET",headers:{"Content-Type":"application/json"}})).json();if(x&&Array.isArray(x.content)){if(C(x.content),x.totalCount){const he=Math.ceil(x.totalCount/t);E(he)}}else C([]);f(s)}catch{j("Lỗi","Có lỗi xảy ra khi tải dữ liệu câu hỏi.",!0)}finally{h(!1)}},ee=async()=>{const t=await(await fetch(`${d}/guest/answers`,{method:"GET",headers:{"Content-Type":"application/json"}})).json();G(t||[])},se=async()=>{const t=await(await fetch(`${d}/guest/educations`,{method:"GET",headers:{"Content-Type":"application/json"}})).json();J(t||[])},te=async()=>{const t=await(await fetch(`${d}/guest/incomes`,{method:"GET",headers:{"Content-Type":"application/json"}})).json();z(t||[])},ne=async()=>{const t=await(await fetch(`${d}/guest/jobs`,{method:"GET",headers:{"Content-Type":"application/json"}})).json();W(t||[]),y(t||[])},r=s=>{const{name:t,value:n}=s.target;T({...i,[t]:n}),m({...c,[t]:""})},ae=(s,t)=>{k({...g,[s]:t}),m({...c,[s]:""})},ie=()=>{M()&&p(!0)},ce=()=>{p(!1)},le=async()=>{if(M()&&P()){h(!0);const s={user_info:i,selected_answers:g};try{const t=await fetch(`${d}/survey-res`,{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify(s)}),n=await t.json();t.ok&&n.averageScores&&n.predictedRiasecType&&n.jobRecommendations?O(n):j("Lỗi",n.message||"Gửi khảo sát không thành công.",!0)}catch{j("Lỗi","Có lỗi xảy ra khi gửi khảo sát.",!0)}finally{h(!1),R()}}},M=()=>{const s={};return i.gender||(s.gender="Vui lòng chọn giới tính."),i.age?(i.age<1||i.age>100)&&(s.age="Tuổi phải từ 1 đến 100."):s.age="Vui lòng nhập tuổi.",i.education||(s.education="Vui lòng chọn trình độ học vấn."),i.income||(s.income="Vui lòng chọn mức thu nhập."),i.employed||(s.employed="Vui lòng chọn tình trạng đi làm."),i.profession||(s.profession="Vui lòng chọn nghề nghiệp."),m(s),Object.keys(s).length===0},P=()=>{const s={};return w.forEach(t=>{g[t.id]||(s[t.id]="Vui lòng chọn một câu trả lời.")}),m(s),Object.keys(s).length===0},j=(s,t,n)=>{Q(s),U(t),K(n),S(!0)},oe=()=>{S(!1)},R=()=>{T({gender:"",age:"",education:"",income:"",employed:"",profession:"",vernacular:""}),$(""),y(b),k({}),m({}),p(!1),f(0),E(0)},re=()=>{p(!1),O(null)},de=s=>{const t=s.target.value;$(t);const n=b.filter(V=>V.jobName.toLowerCase().includes(t.toLowerCase()));y(n)};return e.jsxs("div",{className:"flex items-center justify-center min-h-screen p-4 bg-gray-100 relative",children:[I&&e.jsx("div",{className:"fixed inset-0 bg-gray-800 bg-opacity-50 flex items-center justify-center z-50",children:e.jsx(me,{})}),l?e.jsxs("div",{className:"bg-white rounded-2xl shadow-lg p-4 sm:p-6 md:p-8 w-full max-w-full sm:max-w-md md:max-w-2xl",children:[e.jsxs("div",{className:"flex items-center justify-center space-x-2 mb-6",children:[e.jsx(xe,{className:"text-green-500 text-3xl"}),e.jsx("h2",{className:"text-xl font-semibold text-gray-800",children:"Kết quả khảo sát!"})]}),e.jsxs("div",{className:"mb-6",children:[e.jsxs("div",{className:"flex items-center space-x-2 mb-2",children:[e.jsx(u,{className:"text-indigo-500 text-xl"}),e.jsx("h3",{className:"text-lg font-semibold text-gray-700",children:"Điểm trung bình đã khảo sát theo đặc tính nghề:"})]}),e.jsx("ul",{className:"list-inside list-disc pl-5",children:l.averageScores.map((s,t)=>e.jsxs("li",{className:"text-gray-700",children:[s.topicName,": ",s.score]},t))})]}),e.jsxs("div",{className:"mb-6 flex flex-col space-y-2",children:[e.jsxs("div",{className:"flex items-center space-x-2",children:[e.jsx(u,{className:"text-indigo-500 text-xl"}),e.jsx("h3",{className:"text-lg font-semibold text-gray-700",children:"Nghề nghiệp bạn đã chọn:"})]}),e.jsxs("p",{className:"text-gray-700 pl-5",children:[l.professionSelected," với đặc tính ",e.jsx("span",{className:"font-bold",children:l.topicSelected})]})]}),e.jsxs("div",{className:"mb-6 flex items-center space-x-2",children:[e.jsx(u,{className:"text-indigo-500 text-xl"}),e.jsx("h3",{className:"text-lg font-semibold text-gray-700",children:"Đặc tính nghề phù hợp:"}),e.jsx("p",{className:"text-gray-700",children:l.predictedRiasecType.topicName})]}),e.jsxs("div",{className:"mb-6 flex flex-col space-y-2",children:[e.jsxs("div",{className:"flex items-center space-x-2",children:[e.jsx(u,{className:"text-indigo-500 text-xl"}),e.jsx("h3",{className:"text-lg font-semibold text-gray-700",children:"Đánh giá:"})]}),e.jsx("p",{className:`pl-5 ${l.topicSelected===l.predictedRiasecType.topicName?"text-green-700":"text-red-700"}`,children:l.topicSelected===l.predictedRiasecType.topicName?"Nghề đã chọn phù hợp với bạn. Bạn có thể tham khảo thêm một số ngành nghề đề xuất liên quan!":"Nghề đã chọn có thể chưa phù hợp với bạn. Bạn có thể tham khảo thêm một số ngành nghề đề xuất liên quan!"})]}),e.jsxs("div",{className:"mb-6",children:[e.jsxs("div",{className:"flex items-center space-x-2 mb-2",children:[e.jsx(u,{className:"text-indigo-500 text-xl"}),e.jsx("h3",{className:"text-lg font-semibold text-gray-700",children:"Một số nghề khác phù hợp với đặc tính nghề của bạn:"})]}),e.jsx("ul",{className:"list-inside list-disc pl-5",children:l.jobRecommendations.map((s,t)=>e.jsx("li",{className:"text-gray-700",children:s.jobrecommendValue},t))})]}),e.jsx("div",{className:"flex justify-center",children:e.jsx("button",{onClick:re,className:"px-6 py-3 bg-indigo-500 text-white rounded-lg hover:bg-indigo-600 focus:outline-none focus:ring focus:ring-indigo-300",children:"Quay lại"})})]}):e.jsx("div",{className:"bg-white rounded-2xl shadow-lg p-4 sm:p-6 md:p-8 w-full max-w-full sm:max-w-md md:max-w-2xl",children:D?e.jsxs(e.Fragment,{children:[e.jsx("h2",{className:"text-3xl font-bold mb-6 text-center text-indigo-600",children:"Khảo sát"}),e.jsxs("div",{className:"text-center text-gray-700 mb-6 font-medium",children:[e.jsxs("p",{children:["Hãy xem danh sách các hoạt động sau đây và đánh giá mức độ bạn ",e.jsx("strong",{className:"font-bold",children:"MUỐN"})," thực hiện từng hoạt động."]}),e.jsx("p",{className:"mt-2",children:"1 = Rất không thích; 4 = Trung lập; 7 = Rất thích"})]}),w.map((s,t)=>e.jsxs("div",{className:"mb-5",children:[e.jsx("h3",{className:"block text-gray-700 font-medium mb-2",children:`${t+1}. ${s.question}`}),e.jsx("div",{className:"flex flex-wrap gap-4",children:L.map(n=>e.jsxs("div",{className:"flex items-center",children:[e.jsx("input",{type:"radio",id:`question-${s.id}-answer-${n.id}`,name:`question-${s.id}`,value:n.id,checked:g[s.id]===n.id,onChange:()=>ae(s.id,n.id),className:"mr-2"}),e.jsx("label",{htmlFor:`question-${s.id}-answer-${n.id}`,className:"text-gray-600",children:n.answerName})]},n.id))}),c[s.id]&&e.jsx("p",{className:"text-red-500 text-sm mt-2",children:c[s.id]})]},s.id)),e.jsxs("div",{className:"flex justify-center mt-4",children:[e.jsx("button",{onClick:()=>f(o-1),disabled:o<=0,className:"px-4 py-2 bg-blue-500 text-white rounded mr-2 disabled:bg-gray-400 disabled:cursor-not-allowed",children:"Trước"}),e.jsx("span",{className:"px-4 py-2",children:`Trang ${o+1} / ${N}`}),e.jsx("button",{onClick:()=>{P()&&f(o+1)},disabled:o>=N-1,className:"px-4 py-2 bg-blue-500 text-white rounded ml-2 disabled:bg-gray-400 disabled:cursor-not-allowed ",children:"Sau"})]}),e.jsx(e.Fragment,{children:o+1===N&&e.jsxs("div",{className:"flex justify-center gap-4 mt-4",children:[e.jsx("button",{type:"button",onClick:ce,className:"px-4 py-2 bg-gray-500 text-white rounded-lg hover:bg-gray-600 focus:outline-none focus:ring focus:ring-gray-300",children:"Quay lại"}),e.jsx("button",{type:"button",onClick:le,className:"px-4 py-2 bg-indigo-500 text-white rounded-lg hover:bg-indigo-600 focus:outline-none focus:ring focus:ring-indigo-300",children:"Gửi"}),e.jsx("button",{type:"button",onClick:R,className:"px-4 py-2 bg-red-500 text-white rounded-lg hover:bg-red-600 focus:outline-none focus:ring focus:ring-red-300",children:"Hủy"})]})})]}):e.jsxs(e.Fragment,{children:[e.jsx("h2",{className:"text-3xl font-bold mb-6 text-center text-indigo-600",children:"Thông tin cá nhân"}),e.jsxs("div",{className:"mb-4",children:[e.jsx("label",{className:"block text-gray-700 font-medium mb-2",children:"Giới tính:"}),e.jsxs("div",{className:"flex gap-4",children:[e.jsxs("label",{className:"flex items-center gap-2 cursor-pointer",children:[e.jsx("input",{type:"radio",name:"gender",value:"0",onChange:r,className:"accent-indigo-500",checked:i.gender==="0"})," Nam"]}),e.jsxs("label",{className:"flex items-center gap-2 cursor-pointer",children:[e.jsx("input",{type:"radio",name:"gender",value:"1",onChange:r,className:"accent-indigo-500",checked:i.gender==="1"})," Nữ"]})]}),c.gender&&e.jsx("p",{className:"text-red-500 text-sm mt-2",children:c.gender})]}),e.jsxs("div",{className:"mb-4",children:[e.jsx("label",{className:"block text-gray-700 font-medium mb-2",children:"Tuổi:"}),e.jsx("input",{type:"number",name:"age",onChange:r,className:"border rounded-lg p-3 w-full",placeholder:"Vui lòng nhập tuổi của bạn",value:i.age}),c.age&&e.jsx("p",{className:"text-red-500 text-sm mt-2",children:c.age})]}),e.jsxs("div",{className:"mb-4",children:[e.jsx("label",{className:"block text-gray-700 font-medium mb-2",children:"Trình độ học vấn:"}),e.jsxs("select",{name:"education",onChange:r,className:"border rounded-lg p-3 w-full",value:i.education,children:[e.jsx("option",{value:"",disabled:!0,children:"Chọn trình độ học vấn"}),_.map(s=>e.jsx("option",{value:s.educationCode,children:s.educationName},s.id))]}),c.education&&e.jsx("p",{className:"text-red-500 text-sm mt-2",children:c.education})]}),e.jsxs("div",{className:"mb-4",children:[e.jsx("label",{className:"block text-gray-700 font-medium mb-2",children:"Thu nhập hiện tại hoặc mong muốn:"}),e.jsxs("select",{name:"income",onChange:r,className:"border rounded-lg p-3 w-full",value:i.income,children:[e.jsx("option",{value:"",disabled:!0,children:"Chọn mức thu nhập"}),q.map(s=>e.jsx("option",{value:s.incomeCode,children:s.incomeName},s.id))]}),c.income&&e.jsx("p",{className:"text-red-500 text-sm mt-2",children:c.income})]}),e.jsxs("div",{className:"mb-4",children:[e.jsx("label",{className:"block text-gray-700 font-medium mb-2",children:"Bạn có đang đi làm không?"}),e.jsxs("div",{className:"flex gap-4",children:[e.jsxs("label",{className:"flex items-center gap-2 cursor-pointer",children:[e.jsx("input",{type:"radio",name:"employed",value:"yes",onChange:r,className:"accent-indigo-500",checked:i.employed==="yes"})," Có"]}),e.jsxs("label",{className:"flex items-center gap-2 cursor-pointer",children:[e.jsx("input",{type:"radio",name:"employed",value:"no",onChange:r,className:"accent-indigo-500",checked:i.employed==="no"})," Không"]})]}),c.employed&&e.jsx("p",{className:"text-red-500 text-sm mt-2",children:c.employed})]}),e.jsxs("div",{className:"mb-6",children:[e.jsx("label",{className:"block text-gray-700 font-medium mb-2",children:i.employed==="yes"?"Nghề nghiệp của bạn?":"Nghề nghiệp mơ ước của bạn?"}),e.jsx("input",{type:"text",placeholder:"Tìm kiếm nghề nghiệp...",value:X,onChange:de,className:"border rounded-lg p-3 w-full mb-2"}),e.jsxs("select",{name:"profession",onChange:r,className:"border rounded-lg p-3 w-full",value:i.profession,children:[e.jsx("option",{value:"",disabled:!0,children:"Chọn nghề nghiệp"}),Y.map(s=>e.jsx("option",{value:s.jobCode,children:s.jobName},s.id))]}),c.profession&&e.jsx("p",{className:"text-red-500 text-sm mt-2",children:c.profession})]}),e.jsx("div",{className:"flex justify-center",children:e.jsx("button",{onClick:ie,className:"bg-indigo-500 text-white px-6 py-3 rounded-lg font-semibold hover:bg-indigo-600 transition",children:"Tiếp theo"})})]})}),e.jsx(ue,{isOpen:A,onClose:oe,title:F,message:B,isError:H})]})};export{pe as default};

import{k as E,u as A,r as n,j as e,S as P,M as $}from"./index-CQdfBo2t.js";const G=()=>{const d="/api/v1",{id:g}=E(),m=A(),[r,h]=n.useState({answerName:"",answerValue:""}),[s,c]=n.useState({answerName:"",answerValue:""}),[y,f]=n.useState(!1),[j,b]=n.useState(""),[v,k]=n.useState(""),[p,C]=n.useState(!1),[T,i]=n.useState(!1),[x,w]=n.useState("");n.useEffect(()=>{(async()=>{i(!0);try{const t=localStorage.getItem("token"),a=await fetch(`${d}/answers/${g}`,{method:"GET",headers:{Authorization:`Bearer ${t}`,"Content-Type":"application/json"}});if(a.status===401){const I=await a.json();w(I.detail),o("Thông báo","Phiên đăng nhập đã hết hạn, vui lòng đăng nhập lại.",!0),i(!1);return}const u=await a.json();u?h({answerName:u.answerName,answerValue:u.answerValue}):o("Lỗi","Không tìm thấy câu trả lời.",!0)}catch{o("Lỗi","Có lỗi xảy ra khi tải dữ liệu.",!0)}finally{i(!1)}})()},[g,d]);const N=l=>{const{name:t,value:a}=l.target;h({...r,[t]:a}),c({...s,[t]:""})},S=()=>r.answerName.trim()?r.answerName.length>100?(c({...s,answerName:"Tên câu trả lời không được dài quá 100 ký tự."}),!1):r.answerValue.trim()?isNaN(r.answerValue)?(c({...s,answerValue:"Giá trị câu trả lời phải là một số."}),!1):!0:(c({...s,answerValue:"Giá trị câu trả lời không được để trống."}),!1):(c({...s,answerName:"Tên câu trả lời không được để trống."}),!1),V=async()=>{if(S()){i(!0);try{const l=localStorage.getItem("token"),t=await fetch(`${d}/answers`,{method:"PUT",headers:{Authorization:`Bearer ${l}`,"Content-Type":"application/json"},body:JSON.stringify({id:g,...r})});if(t.status===401){const u=await t.json();w(u.detail),o("Thông báo","Phiên đăng nhập đã hết hạn, vui lòng đăng nhập lại.",!0),i(!1);return}const a=await t.json();a&&a.message==="updated"?o("Thành công","Cập nhật thành công!",!1):o("Lỗi","Cập nhật không thành công.",!0)}catch{o("Lỗi","Có lỗi xảy ra khi cập nhật.",!0)}finally{i(!1)}}},L=()=>{m(-1)},o=(l,t,a)=>{b(l),k(t),C(a),f(!0)},M=()=>{f(!1),p||m(-1),(x=="invalid_token"||x=="jwt_error")&&(localStorage.removeItem("token"),localStorage.removeItem("username"),localStorage.removeItem("roles"),m("/"))};return e.jsxs("div",{className:"flex items-center justify-center min-h-screen p-4 bg-gray-100 relative",children:[T&&e.jsx("div",{className:"fixed inset-0 bg-gray-800 bg-opacity-50 flex items-center justify-center z-50",children:e.jsx(P,{})}),e.jsxs("div",{className:"bg-white rounded-lg shadow-lg p-6 w-full max-w-md",children:[e.jsx("h2",{className:"text-2xl font-bold mb-4 text-gray-800 text-center",children:"Cập Nhật Câu Trả Lời"}),e.jsxs("div",{children:[e.jsxs("div",{className:"mb-4",children:[e.jsx("label",{htmlFor:"answerName",className:"block text-gray-700 font-medium mb-2",children:"Tên Câu Trả Lời"}),e.jsx("input",{type:"text",id:"answerName",name:"answerName",value:r.answerName,onChange:N,className:"w-full px-4 py-2 border rounded-lg focus:outline-none focus:ring focus:ring-indigo-300",placeholder:"Nhập tên câu trả lời"}),s.answerName&&e.jsx("p",{className:"text-red-500 text-sm mt-2",children:s.answerName})]}),e.jsxs("div",{className:"mb-4",children:[e.jsx("label",{htmlFor:"answerValue",className:"block text-gray-700 font-medium mb-2",children:"Giá Trị Câu Trả Lời"}),e.jsx("input",{type:"text",id:"answerValue",name:"answerValue",value:r.answerValue,onChange:N,className:"w-full px-4 py-2 border rounded-lg focus:outline-none focus:ring focus:ring-indigo-300",placeholder:"Nhập giá trị câu trả lời"}),s.answerValue&&e.jsx("p",{className:"text-red-500 text-sm mt-2",children:s.answerValue})]}),e.jsxs("div",{className:"flex justify-center gap-4",children:[e.jsx("button",{type:"button",onClick:V,className:"px-4 py-2 bg-indigo-500 text-white rounded-lg hover:bg-indigo-600 focus:outline-none focus:ring focus:ring-indigo-300",children:"Cập Nhật"}),e.jsx("button",{type:"button",onClick:L,className:"px-4 py-2 bg-gray-300 text-gray-700 rounded-lg hover:bg-gray-400 focus:outline-none focus:ring focus:ring-gray-200",children:"Hủy"})]})]})]}),e.jsx($,{isOpen:y,onClose:M,title:j,message:v,isError:p})]})};export{G as default};

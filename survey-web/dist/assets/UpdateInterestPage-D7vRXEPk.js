import{k as M,u as F,r as c,j as e,S as L,M as O}from"./index-Zlyefp4M.js";const $=()=>{const m="/api/v1",{id:u}=M(),h=F(),[a,g]=c.useState({netSocCode:"",title:"",elementId:"",elementName:"",scaleId:"",scaleName:"",dataValue:""}),[n,x]=c.useState({netSocCode:"",title:"",elementId:"",elementName:"",scaleId:"",scaleName:"",dataValue:""}),[j,p]=c.useState(!1),[y,I]=c.useState(""),[S,C]=c.useState(""),[f,v]=c.useState(!1),[k,d]=c.useState(!1),[N,b]=c.useState("");c.useEffect(()=>{(async()=>{d(!0);try{const s=localStorage.getItem("token"),l=await fetch(`${m}/interests/${u}`,{method:"GET",headers:{Authorization:`Bearer ${s}`,"Content-Type":"application/json"}});if(l.status===401){const D=await l.json();b(D.detail),r("Thông báo","Phiên đăng nhập đã hết hạn, vui lòng đăng nhập lại.",!0),d(!1);return}const o=await l.json();o?g({netSocCode:o.netSocCode,title:o.title,elementId:o.elementId,elementName:o.elementName,scaleId:o.scaleId,scaleName:o.scaleName,dataValue:o.dataValue}):r("Lỗi","Không tìm thấy sở thích.",!0)}catch{r("Lỗi","Có lỗi xảy ra khi tải dữ liệu.",!0)}finally{d(!1)}})()},[u,m]);const i=t=>{const{name:s,value:l}=t.target;g({...a,[s]:l}),x({...n,[s]:""})},w=()=>{const t={};return a.netSocCode.trim()||(t.netSocCode="NetSoc Code không được để trống."),a.title.trim()||(t.title="Title không được để trống."),a.elementId.trim()||(t.elementId="Element ID không được để trống."),a.elementName.trim()||(t.elementName="Element Name không được để trống."),a.scaleId.trim()||(t.scaleId="Scale ID không được để trống."),a.scaleName.trim()||(t.scaleName="Scale Name không được để trống."),a.dataValue.trim()||(t.dataValue="Data Value không được để trống."),x(t),Object.keys(t).length===0},V=async()=>{if(w()){d(!0);try{const t=localStorage.getItem("token"),s=await fetch(`${m}/interests`,{method:"PUT",headers:{Authorization:`Bearer ${t}`,"Content-Type":"application/json"},body:JSON.stringify({id:u,...a})});if(s.status===401){const o=await s.json();b(o.detail),r("Thông báo","Phiên đăng nhập đã hết hạn, vui lòng đăng nhập lại.",!0),d(!1);return}const l=await s.json();l&&l.message==="updated"?r("Thành công","Cập nhật thành công!",!1):r("Lỗi","Cập nhật không thành công.",!0)}catch{r("Lỗi","Có lỗi xảy ra khi cập nhật.",!0)}finally{d(!1)}}},E=()=>{h(-1)},r=(t,s,l)=>{I(t),C(s),v(l),p(!0)},T=()=>{p(!1),f||h(-1),(N=="invalid_token"||N=="jwt_error")&&(localStorage.removeItem("token"),localStorage.removeItem("username"),localStorage.removeItem("roles"),h("/"))};return e.jsxs("div",{className:"flex items-center justify-center min-h-screen p-4 bg-gray-100 relative",children:[k&&e.jsx("div",{className:"fixed inset-0 bg-gray-800 bg-opacity-50 flex items-center justify-center z-50",children:e.jsx(L,{})}),e.jsxs("div",{className:"bg-white rounded-lg shadow-lg p-6 w-full max-w-md",children:[e.jsx("h2",{className:"text-2xl font-bold mb-4 text-gray-800 text-center",children:"Cập Nhật Sở Thích"}),e.jsxs("div",{children:[e.jsxs("div",{className:"mb-4",children:[e.jsx("label",{htmlFor:"netSocCode",className:"block text-gray-700 font-medium mb-2",children:"NetSoc Code"}),e.jsx("input",{type:"text",id:"netSocCode",name:"netSocCode",value:a.netSocCode,onChange:i,className:"w-full px-4 py-2 border rounded-lg focus:outline-none focus:ring focus:ring-indigo-300",placeholder:"Nhập NetSoc Code"}),n.netSocCode&&e.jsx("p",{className:"text-red-500 text-sm mt-2",children:n.netSocCode})]}),e.jsxs("div",{className:"mb-4",children:[e.jsx("label",{htmlFor:"title",className:"block text-gray-700 font-medium mb-2",children:"Title"}),e.jsx("input",{type:"text",id:"title",name:"title",value:a.title,onChange:i,className:"w-full px-4 py-2 border rounded-lg focus:outline-none focus:ring focus:ring-indigo-300",placeholder:"Nhập title"}),n.title&&e.jsx("p",{className:"text-red-500 text-sm mt-2",children:n.title})]}),e.jsxs("div",{className:"mb-4",children:[e.jsx("label",{htmlFor:"elementId",className:"block text-gray-700 font-medium mb-2",children:"Element ID"}),e.jsx("input",{type:"text",id:"elementId",name:"elementId",value:a.elementId,onChange:i,className:"w-full px-4 py-2 border rounded-lg focus:outline-none focus:ring focus:ring-indigo-300",placeholder:"Nhập Element ID"}),n.elementId&&e.jsx("p",{className:"text-red-500 text-sm mt-2",children:n.elementId})]}),e.jsxs("div",{className:"mb-4",children:[e.jsx("label",{htmlFor:"elementName",className:"block text-gray-700 font-medium mb-2",children:"Element Name"}),e.jsx("input",{type:"text",id:"elementName",name:"elementName",value:a.elementName,onChange:i,className:"w-full px-4 py-2 border rounded-lg focus:outline-none focus:ring focus:ring-indigo-300",placeholder:"Nhập Element Name"}),n.elementName&&e.jsx("p",{className:"text-red-500 text-sm mt-2",children:n.elementName})]}),e.jsxs("div",{className:"mb-4",children:[e.jsx("label",{htmlFor:"scaleId",className:"block text-gray-700 font-medium mb-2",children:"Scale ID"}),e.jsx("input",{type:"text",id:"scaleId",name:"scaleId",value:a.scaleId,onChange:i,className:"w-full px-4 py-2 border rounded-lg focus:outline-none focus:ring focus:ring-indigo-300",placeholder:"Nhập Scale ID"}),n.scaleId&&e.jsx("p",{className:"text-red-500 text-sm mt-2",children:n.scaleId})]}),e.jsxs("div",{className:"mb-4",children:[e.jsx("label",{htmlFor:"scaleName",className:"block text-gray-700 font-medium mb-2",children:"Scale Name"}),e.jsx("input",{type:"text",id:"scaleName",name:"scaleName",value:a.scaleName,onChange:i,className:"w-full px-4 py-2 border rounded-lg focus:outline-none focus:ring focus:ring-indigo-300",placeholder:"Nhập Scale Name"}),n.scaleName&&e.jsx("p",{className:"text-red-500 text-sm mt-2",children:n.scaleName})]}),e.jsxs("div",{className:"mb-4",children:[e.jsx("label",{htmlFor:"dataValue",className:"block text-gray-700 font-medium mb-2",children:"Data Value"}),e.jsx("input",{type:"text",id:"dataValue",name:"dataValue",value:a.dataValue,onChange:i,className:"w-full px-4 py-2 border rounded-lg focus:outline-none focus:ring focus:ring-indigo-300",placeholder:"Nhập Data Value"}),n.dataValue&&e.jsx("p",{className:"text-red-500 text-sm mt-2",children:n.dataValue})]}),e.jsxs("div",{className:"flex justify-center gap-4",children:[e.jsx("button",{type:"button",onClick:V,className:"px-4 py-2 bg-indigo-500 text-white rounded-lg hover:bg-indigo-600 focus:outline-none focus:ring focus:ring-indigo-300",children:"Cập Nhật"}),e.jsx("button",{type:"button",onClick:E,className:"px-4 py-2 bg-gray-300 text-gray-700 rounded-lg hover:bg-gray-400 focus:outline-none focus:ring focus:ring-gray-200",children:"Hủy"})]})]})]}),e.jsx(O,{isOpen:j,onClose:T,title:y,message:S,isError:f})]})};export{$ as default};

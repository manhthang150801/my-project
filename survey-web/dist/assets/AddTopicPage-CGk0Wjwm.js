import{r as s,j as e,S as L,M as I}from"./index-Zlyefp4M.js";const O=()=>{const h="/api/v1",[o,d]=s.useState({topicName:""}),[r,i]=s.useState({topicName:""}),[p,g]=s.useState(!1),[f,x]=s.useState(""),[N,y]=s.useState(""),[j,b]=s.useState(!1),[v,l]=s.useState(!1),[m,S]=s.useState(""),T=a=>{const{name:t,value:n}=a.target;d({...o,[t]:n}),i({...r,[t]:""})},k=()=>o.topicName.trim()?o.topicName.length>100?(i({...r,topicName:"Tên chủ đề không được dài quá 100 ký tự."}),!1):!0:(i({...r,topicName:"Tên chủ đề không được để trống."}),!1),w=async()=>{if(k()){l(!0);try{const a=localStorage.getItem("token"),t=await fetch(`${h}/topics`,{method:"POST",headers:{Authorization:`Bearer ${a}`,"Content-Type":"application/json"},body:JSON.stringify(o)});if(t.status===401){const M=await t.json();S(M.detail),c("Thông báo","Phiên đăng nhập đã hết hạn, vui lòng đăng nhập lại.",!0),l(!1);return}const n=await t.json();n&&n.message==="saved"?c("Thành công","Lưu thành công!",!1):c("Lỗi","Lưu không thành công.",!0)}catch{c("Lỗi","Có lỗi xảy ra.",!0)}finally{u(),l(!1)}}},u=()=>{d({topicName:""}),i({topicName:""})},c=(a,t,n)=>{x(a),y(t),b(n),g(!0)},C=()=>{g(!1),(m=="invalid_token"||m=="jwt_error")&&(localStorage.removeItem("token"),localStorage.removeItem("username"),localStorage.removeItem("roles"),navigate("/"))};return e.jsxs("div",{className:"flex items-center justify-center min-h-screen p-4 bg-gray-100 relative",children:[v&&e.jsx("div",{className:"fixed inset-0 bg-gray-800 bg-opacity-50 flex items-center justify-center z-50",children:e.jsx(L,{})}),e.jsxs("div",{className:"bg-white rounded-lg shadow-lg p-6 w-full max-w-md",children:[e.jsx("h2",{className:"text-2xl font-bold mb-4 text-gray-800 text-center",children:"Thêm Chủ Đề"}),e.jsxs("div",{children:[e.jsxs("div",{className:"mb-4",children:[e.jsx("label",{htmlFor:"topicName",className:"block text-gray-700 font-medium mb-2",children:"Tên Chủ Đề"}),e.jsx("input",{type:"text",id:"topicName",name:"topicName",value:o.topicName,onChange:T,className:"w-full px-4 py-2 border rounded-lg focus:outline-none focus:ring focus:ring-indigo-300",placeholder:"Nhập tên chủ đề"}),r.topicName&&e.jsx("p",{className:"text-red-500 text-sm mt-2",children:r.topicName})]}),e.jsxs("div",{className:"flex justify-center gap-4",children:[e.jsx("button",{type:"button",onClick:w,className:"px-4 py-2 bg-indigo-500 text-white rounded-lg hover:bg-indigo-600 focus:outline-none focus:ring focus:ring-indigo-300",children:"Lưu"}),e.jsx("button",{type:"button",onClick:u,className:"px-4 py-2 bg-gray-300 text-gray-700 rounded-lg hover:bg-gray-400 focus:outline-none focus:ring focus:ring-gray-200",children:"Hủy"})]})]})]}),e.jsx(I,{isOpen:p,onClose:C,title:f,message:N,isError:j})]})};export{O as default};
